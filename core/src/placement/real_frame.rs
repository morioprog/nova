use super::Placement;
use crate::board::Board;

impl Board {
    pub fn real_place_frames(&self, placement: &Placement) -> i32 {
        let heights = self.height_array();
        let placement = (placement.axis_x(), placement.rot());
        match placement {
            (1, 0) => get_real_place_frames_10(&heights),
            (1, 1) => get_real_place_frames_11(&heights),
            (1, 2) => get_real_place_frames_12(&heights),
            (2, 0) => get_real_place_frames_20(&heights),
            (2, 1) => get_real_place_frames_21(&heights),
            (2, 2) => get_real_place_frames_22(&heights),
            (2, 3) => get_real_place_frames_23(&heights),
            (3, 0) => 0,
            (3, 1) => get_real_place_frames_31(&heights),
            (3, 2) => get_real_place_frames_32(&heights),
            (3, 3) => get_real_place_frames_33(&heights),
            (4, 0) => get_real_place_frames_40(&heights),
            (4, 1) => get_real_place_frames_41(&heights),
            (4, 2) => get_real_place_frames_42(&heights),
            (4, 3) => get_real_place_frames_43(&heights),
            (5, 0) => get_real_place_frames_50(&heights),
            (5, 1) => get_real_place_frames_51(&heights),
            (5, 2) => get_real_place_frames_52(&heights),
            (5, 3) => get_real_place_frames_53(&heights),
            (6, 0) => get_real_place_frames_60(&heights),
            (6, 2) => get_real_place_frames_62(&heights),
            (6, 3) => get_real_place_frames_63(&heights),
            _ => unreachable!(),
        }
    }
}

fn get_real_place_frames_10(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 12 && h[4] >= 12 => 11,
        _ if h[1] <= 11 && h[2] <= 11 => 0,
        _ if h[2] == 12 && h[3] == 11 => 5,
        _ if h[2] == 12 && h[4] == 11 => 6,
        _ if h[1] == 12 && h[2] == 12 && h[5] == 11 => 13,
        _ if h[2] == 12 && h[5] == 11 => 16,
        _ if h[1] == 12 && h[2] == 12 && h[6] == 11 => 21,
        _ if h[2] == 12 && h[6] == 11 => 22,
        _ if h[1] == 12 && h[2] == 11 => 4,
        _ if h[1] == 12 && h[3] == 11 => 6,
        _ if h[1] == 12 && h[4] == 11 => 13,
        _ if h[1] == 12 && h[5] == 11 => 21,
        _ if h[1] == 12 && h[6] == 11 => 24,
        _ => 0,
    }
}

fn get_real_place_frames_11(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[1] == 12 && h[2] == 12 && h[4] >= 12 => 11,
        _ if h[1] == 11 && h[2] == 12 && h[4] >= 12 => 12,
        _ if h[2] == 12 && h[4] >= 12 => 13,
        _ if h[1] == 11 && h[2] <= 11 => 2,
        _ if h[1] <= 11 && h[2] == 11 => 2,
        _ if h[1] <= 11 && h[2] <= 11 => 0,
        _ if h[1] == 12 && h[2] == 12 && h[3] == 11 => 5,
        _ if h[1] == 11 && h[2] == 12 && h[3] == 11 => 6,
        _ if h[2] == 12 && h[3] == 11 => 7,
        _ if h[2] == 12 && h[4] == 11 => 13, // NOTE: inaccurate
        _ if h[1] >= 13 && h[2] == 12 && h[5] == 11 => 17,
        _ if h[2] == 12 && h[5] == 11 => 16,
        _ if h[2] == 12 && h[6] == 11 => 22,
        _ if h[1] == 12 && h[2] == 11 => 6,
        _ if h[1] == 12 && h[3] == 11 => 13, // NOTE: inaccurate
        _ if h[1] == 12 && h[4] == 11 => 16,
        _ if h[1] == 12 && h[5] == 11 => 20,
        _ if h[1] == 12 && h[6] == 11 => 24,
        _ => 0,
    }
}

fn get_real_place_frames_12(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 12 && h[4] == 12 => 11,
        _ if h[2] == 12 && h[4] >= 13 => 10,
        _ if h[1] == 11 && h[2] == 10 && h[4] <= 11 => 8,
        _ if h[1] == 11 && h[2] <= 11 => 6,
        _ if h[1] <= 11 && h[2] == 11 => 6,
        _ if h[1] <= 11 && h[2] <= 11 && h[4] >= 12 => -2,
        _ if h[1] <= 11 && h[2] <= 11 => 0,
        _ if h[2] == 12 && h[3] == 11 => 5,
        _ if h[2] == 12 && h[4] == 11 => 10,
        _ if h[2] == 12 && h[5] == 11 => 16,
        _ if h[2] == 12 && h[6] == 11 => 19,
        _ => 0,
    }
}

fn get_real_place_frames_20(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 12 && h[4] >= 12 => 13,
        _ if h[2] <= 11 => 0,
        _ if h[2] == 12 && h[3] == 11 => 6,
        _ if h[2] == 12 && h[4] == 11 => 8,
        _ if h[1] >= 13 && h[2] == 12 && h[5] == 11 => 13,
        _ if h[2] == 12 && h[5] == 11 => 14,
        _ if h[2] == 12 && h[6] == 11 => 15,
        _ => 0,
    }
}

fn get_real_place_frames_21(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 12 && h[4] >= 12 => 15,
        _ if h[2] <= 9 && h[4] <= 9 => 0,
        _ if h[2] == 10 && h[4] <= 9 => 2,
        _ if h[2] <= 9 && h[4] == 10 => 2,
        _ if h[2] <= 11 && h[4] <= 11 => 4,
        // TODO: what about (_, 11, 11, _, _, _)?
        // TODO: what about (_, 8, 9, _, _, _)?
        // TODO: what about (_, 9, 8, _, _, _)?
        _ if h[2] <= 11 && h[2] == h[3] && h[4] > 11 => -2,
        _ if h[2] <= 8 && h[3] <= 8 && h[4] >= 12 => -2,
        _ if h[2] == 9 && h[3] <= 8 && h[4] >= 12 => 0,
        _ if h[2] <= 8 && h[3] == 9 && h[4] >= 12 => 0,
        _ if h[2] == 10 && h[3] <= 9 && h[4] >= 12 => 2,
        _ if h[2] <= 9 && h[3] == 10 && h[4] >= 12 => 2,
        _ if h[2] <= 11 && h[4] >= 12 => 4,
        _ if h[2] == 12 && h[3] == 11 => 0, // NOTE: not ready yet
        _ if h[2] == 12 && h[4] == 11 => 15,
        _ if h[2] == 12 && h[5] == 11 => 15,
        _ if h[2] == 12 && h[6] == 11 => 18,
        _ => 0,
    }
}

fn get_real_place_frames_22(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 11 => 8,
        _ if h[2] < 11 => 1,
        _ => 0,
    }
}

fn get_real_place_frames_23(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[1] == 12 && h[2] == 12 && h[4] >= 12 => 11,
        _ if h[1] == 11 && h[2] == 12 && h[4] >= 12 => 14,
        _ if h[2] == 12 && h[4] >= 12 => 15,
        _ if h[1] <= 11 && h[2] <= 11 && h[1] == h[2] => 0,
        _ if h[1] <= 9 && h[2] <= 11 && h[1] > h[2] => 0,
        _ if h[1] == 10 && h[2] <= 11 && h[1] > h[2] => 2,
        _ if h[1] == 11 && h[2] <= 11 && h[1] > h[2] => 4,
        _ if h[1] <= 11 && h[2] <= 9 && h[1] < h[2] => 0,
        _ if h[1] <= 11 && h[2] == 10 && h[1] < h[2] => 2,
        _ if h[1] <= 11 && h[2] == 11 && h[1] < h[2] => 4,
        _ if h[1] == 12 && h[2] == 12 && h[3] == 11 => 8,
        _ if h[2] == 12 && h[3] == 11 => 10,
        _ if h[1] == 12 && h[2] == 12 && h[4] == 11 => 6,
        _ if h[1] == 11 && h[2] == 12 && h[4] == 11 => 8,
        _ if h[2] == 12 && h[4] == 11 => 9,
        _ if h[2] == 12 && h[5] == 11 => 12,
        _ if (h[1] == 11 || h[1] == 12) && h[2] == 12 && h[6] == 11 => 14,
        _ if h[2] == 12 && h[6] == 11 => 15,
        _ if h[1] == 12 && h[2] == 11 => 9,
        _ if h[1] == 12 && h[3] == 11 => 9,
        _ if h[1] == 12 && h[4] == 11 => 11,
        _ if h[1] == 12 && h[5] == 11 => 14,
        _ if h[1] == 12 && h[6] == 11 => 16,
        _ => 0,
    }
}

fn get_real_place_frames_31(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] >= 12 && h[4] == 12 => 17,
        _ if h[4] == 11 => 6,
        _ if h[4] < 11 => 2,
        _ if h[3] == 11 && h[4] == 12 => 0, // NOTE: not ready yet
        _ if h[2] == 11 && h[4] == 12 => 11,
        _ if h[1] == 11 && h[4] == 12 => 11,
        _ => 0,
    }
}

fn get_real_place_frames_32(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] <= 11 => 0,
        _ if h[4] <= 11 => 0,
        _ if h[2] >= 12 && h[4] >= 12 => 3,
        _ => 0,
    }
}

fn get_real_place_frames_33(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 12 && h[4] >= 12 => 17,
        _ if h[2] <= 8 && h[3] <= 8 => 0,
        _ if h[2] == 9 && h[3] <= 9 => 2,
        _ if h[2] <= 9 && h[3] == 9 => 2,
        _ if h[2] < 11 => 4,
        _ if h[2] == 11 => 6,
        _ if h[2] == 12 && h[3] == 11 => 0, // NOTE: not ready yet
        _ if h[2] == 12 && h[4] == 11 => 11,
        _ if h[2] == 12 && h[5] == 11 => 11,
        _ if h[2] == 12 && h[6] == 11 => 15,
        _ => 0,
    }
}

fn get_real_place_frames_40(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] >= 12 && h[4] == 12 => 13,
        _ if h[4] <= 11 => 0,
        _ if h[3] == 11 && h[4] == 12 => 6,
        _ if h[2] == 11 && h[4] == 12 => 8,
        _ if h[1] == 11 && h[4] == 12 => 14,
        _ => 0,
    }
}

fn get_real_place_frames_41(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] >= 12 && h[4] == 12 && h[5] == 12 => 11,
        _ if h[2] >= 12 && h[4] == 12 && h[5] == 11 => 14,
        _ if h[2] >= 12 && h[4] == 12 => 15,
        _ if h[4] <= 11 && h[5] <= 11 && h[4] == h[5] => 0,
        _ if h[4] <= 9 && h[5] <= 9 => 0,
        _ if h[4] == 10 && h[5] <= 9 => 2,
        _ if h[4] <= 9 && h[5] == 10 => 2,
        _ if h[4] <= 11 && h[5] <= 11 => 4,
        _ if h[3] == 11 && h[4] == 12 && h[5] == 12 => 8,
        _ if h[3] == 11 && h[4] == 12 && h[5] == 11 => 9,
        _ if h[3] == 11 && h[4] == 12 => 10,
        _ if h[2] == 11 && h[4] == 12 && h[5] == 12 => 6,
        _ if h[2] == 11 && h[4] == 12 && h[5] == 11 => 8,
        _ if h[2] == 11 && h[4] == 12 => 9,
        _ if h[1] == 11 && h[4] == 12 && h[5] == 11 => 11,
        _ if h[1] == 11 && h[4] == 12 => 13,
        _ if h[4] == 11 && h[5] == 12 => 9,
        _ if h[3] == 11 && h[5] == 12 => 9,
        _ if h[2] == 11 && h[5] == 12 => 9,
        _ if h[1] == 11 && h[5] == 12 => 13,
        _ => 0,
    }
}

fn get_real_place_frames_42(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[4] == 11 => 8,
        _ if h[4] < 11 => 1,
        _ => 0,
    }
}

fn get_real_place_frames_43(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] >= 12 && h[4] == 12 => 15,
        _ if h[2] <= 9 && h[4] <= 9 => 0,
        _ if h[2] == 10 && h[4] <= 9 => 2,
        _ if h[2] <= 9 && h[4] == 10 => 2,
        _ if h[2] <= 11 && h[4] <= 11 => 4,
        _ if h[2] > 11 && h[4] <= 11 && h[3] == h[4] => -2,
        _ if h[2] > 11 && h[3] <= 9 && h[4] <= 9 => 0,
        _ if h[2] > 11 && h[3] == 10 && h[4] <= 9 => 2,
        _ if h[2] > 11 && h[3] <= 9 && h[4] == 10 => 2,
        _ if h[2] > 11 && h[4] <= 11 => 4,
        _ if h[3] == 11 && h[4] == 12 => 0, // NOTE: not ready yet
        _ if h[2] == 11 && h[4] == 12 => 15,
        _ if h[1] == 11 && h[4] == 12 => 15,
        _ => 0,
    }
}

fn get_real_place_frames_50(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] >= 12 && h[4] == 12 && h[5] <= 12 && h[6] <= 12 => 10,
        _ if h[2] >= 12 && h[4] == 12 && h[5] <= 12 => 11,
        _ if h[4] <= 11 && h[5] <= 11 => 1,
        _ if h[3] == 11 && h[4] == 12 => 7,
        _ if h[2] == 11 && h[4] == 12 => 6,
        _ if h[1] == 11 && h[4] == 12 && h[5] == 12 => 12,
        _ if h[1] == 11 && h[4] == 12 => 13,
        _ if h[4] == 11 && h[5] == 12 => 6,
        _ if h[3] == 11 && h[5] == 12 && h[6] <= 12 => 5,
        _ if h[3] == 11 && h[5] == 12 && h[6] > 12 => 7,
        _ if h[2] == 11 && h[5] == 12 => 11,
        _ if h[1] == 11 && h[5] == 12 => 12,
        _ => 0,
    }
}

fn get_real_place_frames_51(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] >= 12 && h[4] == 12 && h[5] <= 11 && h[6] <= 11 => 11,
        _ if h[2] >= 12 && h[4] == 12 && h[5] == 11 && h[6] == 12 => 12,
        _ if h[2] >= 12 && h[4] == 12 && h[5] == 12 && h[6] == 11 => 12,
        _ if h[2] >= 12 && h[4] == 12 => 13,
        _ if h[4] <= 11 && h[5] == 11 && h[6] <= 11 => 2,
        _ if h[4] <= 11 && h[5] < 11 && h[6] <= 11 => 1,
        _ if h[3] == 11 && h[4] == 12 => 8,
        _ if h[2] == 11 && h[4] == 12 => 7,
        _ if h[1] == 11 && h[4] == 12 => 12,
        _ if h[4] == 11 && h[5] == 12 => 8,
        _ if h[3] == 11 && h[5] == 12 && h[6] == 12 => 4,
        _ if h[3] == 11 && h[5] == 12 => 7,
        _ if h[2] == 11 && h[5] == 12 => 11,
        _ if h[1] == 11 && h[5] == 12 && (h[6] == 11 || h[6] == 12) => 13,
        _ if h[1] == 11 && h[5] == 12 => 14,
        _ if h[5] == 11 && h[6] == 12 => 10,
        _ if h[4] == 11 && h[6] == 12 => 7,
        _ if h[3] == 11 && h[6] == 12 => 7,
        _ if h[2] == 11 && h[6] == 12 => 11,
        _ if h[1] == 11 && h[6] == 12 => 14,
        _ => 0,
    }
}

fn get_real_place_frames_52(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 12 && h[4] == 12 => 12,
        _ if h[2] > 12 && h[4] == 12 => 10,
        _ if h[4] == 11 && h[5] <= 11 => 8,
        _ if h[4] < 11 && h[5] < 11 && h[6] <= 11 => 2,
        _ if h[4] < 11 && h[5] == 11 && h[6] <= 11 => 9,
        _ if h[2] <= 11 && h[4] < 11 && h[5] < 11 && h[6] > 11 => 2,
        _ if h[2] <= 11 && h[4] < 11 && h[5] == 11 && h[6] > 11 => 9,
        _ if h[2] > 11 && h[4] < 11 && h[5] < 11 && h[6] > 11 => -1,
        _ if h[2] > 11 && h[4] < 11 && h[5] == 11 && h[6] > 11 => 6,
        _ if h[3] == 11 && h[4] == 12 => 9,
        _ if h[2] == 11 && h[4] == 12 && h[6] <= 12 => 9,
        _ if h[2] == 11 && h[4] == 12 && h[6] > 12 => 9,
        _ if h[1] == 11 && h[4] == 12 && h[5] == 11 && h[6] <= 12 => 13,
        _ if h[1] == 11 && h[4] == 12 && h[6] <= 12 => 14,
        _ if h[1] == 11 && h[4] == 12 && h[5] == 11 && h[6] > 12 => 13,
        _ if h[1] == 11 && h[4] == 12 && h[6] > 12 => 14,
        _ => 0,
    }
}

fn get_real_place_frames_53(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 12 && h[4] == 12 && h[5] == 12 => 11,
        _ if h[2] == 12 && h[4] == 12 && h[5] == 11 => 12,
        _ if h[2] == 12 && h[4] == 12 => 13,
        _ if h[2] > 12 && h[4] == 12 && h[5] == 12 => 9,
        _ if h[2] > 12 && h[4] == 12 && h[5] == 11 => 12,
        _ if h[2] > 12 && h[4] == 12 => 13,
        _ if h[2] >= 12 && h[4] <= 11 && h[5] <= 11 && h[4] == h[5] => -2,
        _ if h[2] >= 12 && h[4] <= 9 && h[5] <= 9 => -2,
        _ if h[2] >= 12 && h[4] == 10 && h[5] <= 9 => 0,
        _ if h[2] >= 12 && h[4] <= 9 && h[5] == 10 => 0,
        _ if h[2] >= 12 && h[4] <= 11 && h[5] <= 11 => 2,
        _ if h[2] < 12 && h[4] == 11 && h[5] <= 11 => 2,
        _ if h[2] < 12 && h[4] <= 11 && h[5] == 11 => 2,
        _ if h[2] < 12 && h[4] <= 11 && h[5] <= 11 => 1,
        _ if h[3] == 11 && h[4] == 12 && (h[5] == 11 || h[5] == 12) => 6,
        _ if h[3] == 11 && h[4] == 12 => 7,
        _ if h[2] == 11 && h[4] == 12 && h[5] >= 11 => 7,
        _ if h[2] == 11 && h[4] == 12 => 8,
        _ if h[1] == 11 && h[4] == 12 => 11,
        _ if h[4] == 11 && h[5] == 12 => 6,
        _ if h[3] == 11 && h[5] == 12 => 8,
        _ if h[1] <= 12 && h[2] == 11 && h[5] == 12 => 11,
        _ if h[1] > 12 && h[2] == 11 && h[5] == 12 => 8,
        _ if h[1] == 11 && h[5] == 12 => 13,
        _ => 0,
    }
}

fn get_real_place_frames_60(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] >= 12 && h[4] == 12 && h[6] == 12 => 9,
        _ if h[2] >= 12 && h[4] == 12 => 10,
        _ if h[4] <= 11 && h[5] <= 11 && h[6] <= 11 => 0,
        _ if h[3] == 11 && h[4] == 12 => 5,
        _ if h[2] == 11 && h[4] == 12 => 5,
        _ if h[1] == 11 && h[4] == 12 && h[6] == 12 => 13,
        _ if h[1] == 11 && h[4] == 12 => 14,
        _ if h[4] == 11 && h[5] == 12 => 3,
        _ if h[3] == 11 && h[5] == 12 => 4,
        _ if h[2] == 11 && h[5] == 12 => 11,
        _ if h[1] == 11 && h[5] == 12 && h[6] == 12 => 10,
        _ if h[1] == 11 && h[5] == 12 => 14,
        _ if h[5] == 11 && h[6] == 12 => 5,
        _ if h[4] == 11 && h[6] == 12 => 4,
        _ if h[3] == 11 && h[6] == 12 => 10,
        _ if h[2] == 11 && h[6] == 12 => 10,
        _ if h[1] == 11 && h[6] == 12 => 13,
        _ => 0,
    }
}

fn get_real_place_frames_62(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] == 12 && h[4] == 12 => 12,
        _ if h[2] > 12 && h[4] == 12 => 9,
        _ if h[4] <= 11 && h[5] == 10 && h[6] == 11 => 9,
        _ if h[4] <= 11 && h[5] == 11 && h[6] <= 11 => 7,
        _ if h[4] <= 11 && h[5] <= 11 && h[6] == 11 => 7,
        _ if h[4] <= 11 && h[5] <= 11 && h[6] <= 11 => 0,
        _ if h[3] == 11 && h[4] == 12 && h[5] == 12 => 7,
        _ if h[3] == 11 && h[4] == 12 && h[5] < 12 => 5,
        _ if h[2] == 11 && h[4] == 12 => 10,
        _ if h[1] == 11 && h[4] == 12 => 12,
        _ if h[4] == 11 && h[5] == 12 => 8,
        _ if h[3] == 11 && h[5] == 12 => 7,
        _ if h[2] == 11 && h[5] == 12 => 12,
        _ if h[1] == 11 && h[5] == 12 => 15,
        _ => 0,
    }
}

fn get_real_place_frames_63(h: &[usize; 8]) -> i32 {
    match () {
        _ if h[2] > 12 && h[4] == 12 && h[5] == h[6] => 9,
        _ if h[2] > 12 && h[4] == 12 && (h[5] == 12 || h[6] == 12) => 11,
        _ if h[2] > 12 && h[4] == 12 => 9,
        _ if h[2] >= 12 && h[4] == 12 => 10,
        _ if h[4] <= 11 && h[5] <= 11 && h[6] <= 11 => 0,
        _ if h[3] == 11 && h[4] == 12 => 5,
        _ if h[2] == 11 && h[4] == 12 => 7,
        _ if h[1] == 11 && h[4] == 12 => 11,
        _ if h[4] == 11 && h[5] == 12 => 5,
        _ if h[3] == 11 && h[5] == 12 && h[6] == 12 => 4,
        _ if h[3] == 11 && h[5] == 12 && h[6] == 11 => 5,
        _ if h[3] == 11 && h[5] == 12 => 6,
        _ if h[2] == 11 && h[5] == 12 => 11,
        _ if h[1] == 11 && h[5] == 12 => 14,
        _ if h[5] == 11 && h[6] == 12 => 4,
        _ if h[2] >= 12 && h[4] == 11 && h[6] == 12 => 5,
        _ if h[2] < 12 && h[4] == 11 && h[6] == 12 => 5,
        _ if h[3] == 11 && h[6] == 12 => 6,
        _ if h[2] == 11 && h[6] == 12 => 11,
        _ if h[1] == 11 && h[6] == 12 => 14,
        _ => 0,
    }
}
